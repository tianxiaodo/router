<html>
<head>
	<title>Router.js Test</title>
	<script type="text/javascript" src="../router.js"></script>
	<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
	<script type="text/javascript">
	ignorecase="books";
	var router =new Router()
	.addRoute("#/users/:user33",function(req,next){
		console.group();
		console.log("get : name=",req.get("user33"));
		console.log("href=",req.href);
		console.log("params=",req.params);
		console.log("query=",req.query);
		console.log("splats=",req.splats);
		console.log("hasNext=",req.hasNext);
		console.log("get(default:15) age=",req.get("age",15));

		console.log(ignorecase);
		//console.log(p);
		//router.pause();
		//router._paused=true;
		//router.redirect("#/books/chn")

		//console.log("test pause");

		//router.setLocation("#/users/xiaoxiao");
		//router._route(router._extractFragment(url) );

		//router.pause();
		//document.location.href='#/books/chn'; //This will be ignored until you call play
		//router.play();

		console.groupEnd();
		//redirect.redirect()
		// if(req.hasNext){
		 	next();
		// }
		//$(".div1").html("this is "+req.get("name")+"\'s page");
	}.bind(this))
	.addRoute("#/users/xiaoming",function(req,next){
		console.group();
		console.log("xiaoming");
		//next('not found',404);

		//router.destroy();

		console.groupEnd();
	})
	.addRoute("#/books/*",function(req,next){
		console.group();
		console.log("get : name=",req.get("user"));
		console.log("href=",req.href);
		console.log("params=",req.params);
		console.log("query=",req.query);
		console.log("splats=",req.splats);
		console.log("hasNext=",req.hasNext);
		console.log("get(default:15) age=",req.get("age",15))
		if(req.hasNext){
			next();
		}
		console.groupEnd();
	})
	.addRoute(/#\/mac\/([\w]*)?\.(com|cn)/i,function(req,next){
		console.group();
		console.log("get : name=",req.get("user"));
		console.log("href=",req.href);
		console.log("params=",req.params);
		console.log("query=",req.query);
		console.log("splats=",req.splats);
		console.log("hasNext=",req.hasNext);
		console.log("get(default:15) age=",req.get("age",15))
		if(req.hasNext){
			next();
		}
		console.groupEnd();
	})
	/*=== before：在正常匹配之前执行的逻辑，不包括404 ===*/
	/*=========== 多个before 按加载顺序执行 ==========*/
	.before(function(req,next){
		console.log("before2 addroute do this");
		next();
	})
	.before(function(req,next){
		console.log("before1 addroute do this");
		next();
		//next("",500);
	})
	.errors(404,function(){
		//console.warn(arguments[1]+" is not defined");
		console.warn(arguments);
		//div1").html("this is "+req.get("name")+"\'s page");
	})
	//
	// .errors(500,function(){
	// 	console.warn("500");
	// })
	 //.run("#/users/wangxun")
// 	window.onpopstate = function(event){
//     console.log(event.state);
// }
</script>

<style>
	*{
		margin:0;
		padding: 0;
	}
	html,body{
		width:100%;
		height:100%;
	}
	.div1{
		width:40%;
		height:200%;
		float: left;
		margin:5%;
		border:1px solid black;
		box-sizing: border-box;
	}
	.div2{
		width:40%;
		height:200%;
		margin:5%;
		float:left;
		border:1px solid black;
		box-sizing: border-box;
	}
</style>
<script type="text/javascript">

</script>
</head>
<body>
<div class="div1">

	</div>
</div>
<div class="div2">
	<a href="#/users/xiaoming"> link to xiaoming</a><br>
	<a href="#/users/qiudong?age=18&heigth=180"> link to qiudong</a><br>
	<a href="#/404page"> 404 pages</a><br>
	<a href="#/books/English/lesson?pageIndex=15"> books/English</a><br>
	<a href="#/mac/baidu.com?pageIndex=15"> #/mac/baidu.com?pageIndex=15</a><br>
	<a href="#/xiaoming"> link to a xiaoming</a><br>
</div>
<div id="xiaoming">
xiaoming
</div>
</body>
</html>
